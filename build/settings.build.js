(()=>{"use strict";var e={n:s=>{var n=s&&s.__esModule?()=>s.default:()=>s;return e.d(n,{a:n}),n},d:(s,n)=>{for(var t in n)e.o(n,t)&&!e.o(s,t)&&Object.defineProperty(s,t,{enumerable:!0,get:n[t]})},o:(e,s)=>Object.prototype.hasOwnProperty.call(e,s)};const s=window.React;var n=e.n(s);const t=window.wp.element,a=window.wp.i18n,i=window.wp.components,r=window.wp.apiFetch;var o=e.n(r);const l=window.ReactJSXRuntime,p=()=>{const[e,t]=(0,s.useState)({base_url:"",company_name:"",api_username:"",api_password:""}),[r,p]=(0,s.useState)(!1),[c,d]=(0,s.useState)(!1),[_,y]=(0,s.useState)(""),[u,w]=(0,s.useState)("");return(0,s.useEffect)((()=>{(async()=>{p(!0);try{const e=(await o()({path:"/wp/v2/settings"})).spire_sync_settings;t(e)}catch(e){w((0,a.__)("Failed to load settings","spire-sync")),console.error("Error loading settings:",e)}finally{p(!1)}})()}),[]),r?(0,l.jsx)("div",{children:(0,a.__)("Loading...","spire-sync")}):(0,l.jsxs)("div",{className:"spire-sync-settings-container",children:[(0,l.jsx)("h1",{children:(0,a.__)("Spire Sync Settings","spire-sync")}),_&&(0,l.jsx)(i.Notice,{status:"success",isDismissible:!0,onDismiss:()=>y(""),children:_}),u&&(0,l.jsx)(i.Notice,{status:"error",isDismissible:!0,onDismiss:()=>w(""),children:u}),(0,l.jsx)(i.Panel,{header:"Settings",children:(0,l.jsx)(n().Fragment,{children:(0,l.jsxs)(i.PanelBody,{title:(0,a.__)("API Settings","spire-sync"),initialOpen:!0,children:[(0,l.jsx)(i.PanelRow,{children:(0,l.jsx)(i.__experimentalInputControl,{__next40pxDefaultSize:!0,label:(0,a.__)("Base URL","spire-sync"),value:e.base_url,onChange:s=>t({...e,base_url:s||""}),help:(0,a.__)("Enter the base URL for the Spire API (e.g., http://example.com/api/v2)","spire-sync"),style:{width:"400px"}})}),(0,l.jsx)(i.PanelRow,{children:(0,l.jsx)(i.__experimentalInputControl,{__next40pxDefaultSize:!0,label:(0,a.__)("Company Name","spire-sync"),value:e.company_name,onChange:s=>t({...e,company_name:s||""}),style:{width:"400px"}})}),(0,l.jsx)(i.PanelRow,{children:(0,l.jsx)(i.__experimentalInputControl,{__next40pxDefaultSize:!0,label:(0,a.__)("API Username","spire-sync"),value:e.api_username,onChange:s=>t({...e,api_username:s||""}),style:{width:"400px"}})}),(0,l.jsx)(i.PanelRow,{children:(0,l.jsx)(i.__experimentalInputControl,{__next40pxDefaultSize:!0,label:(0,a.__)("API Password","spire-sync"),type:"password",value:e.api_password,onChange:s=>t({...e,api_password:s||""}),style:{width:"400px"}})})]})},"0")}),(0,l.jsx)(i.Button,{variant:"primary",onClick:async()=>{d(!0),y(""),w("");try{const s=await o()({path:"/spire-sync/v1/encrypt",method:"POST",data:{data:e.api_password}}),n={...e,api_password:s.data},t=await o()({path:"/wp/v2/settings",method:"POST",data:{spire_sync_settings:n}});y((0,a.__)("Settings saved successfully","spire-sync")),console.log("Settings saved:",t)}catch(e){w((0,a.__)("Failed to save settings","spire-sync")),console.error("Error saving settings:",e)}finally{d(!1)}},disabled:c,children:c?(0,a.__)("Saving...","spire-sync"):(0,a.__)("Save Settings","spire-sync")})]})};document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("spire-sync-settings-root");e&&(0,t.createRoot)(e).render((0,l.jsx)(p,{}))}))})();