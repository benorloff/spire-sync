(()=>{"use strict";var e={n:s=>{var n=s&&s.__esModule?()=>s.default:()=>s;return e.d(n,{a:n}),n},d:(s,n)=>{for(var t in n)e.o(n,t)&&!e.o(s,t)&&Object.defineProperty(s,t,{enumerable:!0,get:n[t]})},o:(e,s)=>Object.prototype.hasOwnProperty.call(e,s)};const s=window.React;var n=e.n(s);const t=window.wp.element,i=window.wp.i18n,a=window.wp.components,r=window.wp.apiFetch;var o=e.n(r);const c=window.ReactJSXRuntime,p=()=>{const{baseUrl:e,setBaseUrl:s,companyName:r,setCompanyName:p,apiUsername:l,setApiUsername:_,apiPassword:d,setApiPassword:y,syncType:u,setSyncType:m,syncProducts:g,setSyncProducts:S,syncOrders:h,setSyncOrders:w,syncCustomers:x,setSyncCustomers:v,message:C,setMessage:P,isTesting:j,isSaving:b,isValidConnection:T,wcVersion:f,handleTestConnection:I,saveSettings:O}=(()=>{const[e,s]=(0,t.useState)({spire_sync_settings:{spire_api:{},sync_options:{}},isSaving:!1,isTesting:!1,isValidConnection:!1,message:"",wcVersion:""}),[n,a]=(0,t.useState)(""),[r,c]=(0,t.useState)(""),[p,l]=(0,t.useState)(""),[_,d]=(0,t.useState)(""),[y,u]=(0,t.useState)("update"),[m,g]=(0,t.useState)(!1),[S,h]=(0,t.useState)(!1),[w,x]=(0,t.useState)(!1),[v,C]=(0,t.useState)(!1),[P,j]=(0,t.useState)(!1),[b,T]=(0,t.useState)(""),[f,I]=(0,t.useState)(!1),[O,R]=(0,t.useState)("");return(0,t.useEffect)((()=>{o()({path:"/wp/v2/settings"}).then((e=>{const s=e.spire_sync_settings;console.log("spire_sync_settings",s),a(s.spire_api?.base_url||""),c(s.spire_api?.company_name||""),l(s.spire_api?.api_username||""),d(s.spire_api?.api_password||""),u(s.sync_options?.type||"update"),g(s.sync_options?.sync_products||!1),h(s.sync_options?.sync_orders||!1),x(s.sync_options?.sync_customers||!1)})),o()({path:"/wc/v3/system_status"}).then((e=>{var s;const n=null!==(s=e.environment.version)&&void 0!==s?s:"";R(n)}))}),[]),{settings:e,setSettings:s,baseUrl:n,setBaseUrl:a,companyName:r,setCompanyName:c,apiUsername:p,setApiUsername:l,apiPassword:_,setApiPassword:d,syncType:y,setSyncType:u,syncProducts:m,setSyncProducts:g,syncOrders:S,setSyncOrders:h,syncCustomers:w,setSyncCustomers:x,message:b,setMessage:T,isTesting:P,setIsTesting:j,isValidConnection:f,setIsValidConnection:I,wcVersion:O,setWcVersion:R,isSaving:v,setIsSaving:C,handleTestConnection:async()=>{j(!0),T("");let e={success:!1,message:""};o()({path:"/spire_sync/v1/test-connection",method:"POST",data:{base_url:n,company_name:r,api_username:p,api_password:_}}).then((s=>{if(e=s,!e.success)return j(!1),I(!1),void T((0,i.__)("Invalid credentials. Please try again.","spire-sync"));j(!1),I(!0),T((0,i.__)("Connection successful!","spire-sync"))})).catch((e=>{j(!1),I(!1),T((0,i.__)("An error occurred while testing the connection.","spire-sync")),console.error(e)}))},saveSettings:async()=>{C(!0),T(""),o()({path:"/wp/v2/settings",method:"POST",data:{spire_sync_settings:{spire_api:{base_url:n,company_name:r,api_username:p,api_password:_}}}}).then((e=>{console.log("Settings saved:",e),C(!1),T((0,i.__)("Settings saved successfully.","spire-sync"))})).catch((e=>{C(!1),T((0,i.__)("Error saving settings.","spire-sync")),console.error(e)}))}}})();return(0,c.jsxs)("div",{className:"spire-sync-settings-container",children:[(0,c.jsx)("h1",{children:(0,i.__)("Spire Sync Settings","spire-sync")}),C&&(0,c.jsx)(a.Notice,{status:"success",isDismissible:!0,onDismiss:()=>P(""),children:C}),(0,c.jsx)(a.Panel,{header:"Settings",children:(0,c.jsxs)(n().Fragment,{children:[(0,c.jsxs)(a.PanelBody,{title:(0,i.__)("API Settings","spire-sync"),initialOpen:!0,children:[(0,c.jsx)(a.PanelRow,{children:(0,c.jsx)(a.__experimentalInputControl,{__next40pxDefaultSize:!0,label:(0,i.__)("Base URL","spire-sync"),value:e,onChange:e=>s(e||""),help:(0,i.__)("Enter the base URL for the Spire API (e.g., http://example.com/api/v2)","spire-sync"),style:{width:"400px"}})}),(0,c.jsx)(a.PanelRow,{children:(0,c.jsx)(a.__experimentalInputControl,{__next40pxDefaultSize:!0,label:(0,i.__)("Company Name","spire-sync"),value:r,onChange:e=>p(e||""),style:{width:"400px"}})}),(0,c.jsx)(a.PanelRow,{children:(0,c.jsx)(a.__experimentalInputControl,{__next40pxDefaultSize:!0,label:(0,i.__)("API Username","spire-sync"),value:l,onChange:e=>_(e||""),style:{width:"400px"}})}),(0,c.jsx)(a.PanelRow,{children:(0,c.jsx)(a.__experimentalInputControl,{__next40pxDefaultSize:!0,label:(0,i.__)("API Password","spire-sync"),type:"password",value:d,onChange:e=>y(e||""),style:{width:"400px"}})}),(0,c.jsx)(a.PanelRow,{children:(0,c.jsx)(a.Button,{variant:"secondary",onClick:I,disabled:j,children:j?(0,i.__)("Testing...","spire-sync"):(0,i.__)("Test Connection","spire-sync")})})]}),(0,c.jsx)(a.PanelBody,{title:(0,i.__)("Sync Settings","spire-sync"),initialOpen:!0})]},"0")}),(0,c.jsx)(a.Button,{variant:"primary",onClick:O,disabled:b,children:b?(0,i.__)("Saving...","spire-sync"):(0,i.__)("Save Settings","spire-sync")})]})};document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("spire-sync-settings-root");e&&(0,t.createRoot)(e).render((0,c.jsx)(p,{}))}))})();