(()=>{"use strict";var e={n:s=>{var n=s&&s.__esModule?()=>s.default:()=>s;return e.d(n,{a:n}),n},d:(s,n)=>{for(var t in n)e.o(n,t)&&!e.o(s,t)&&Object.defineProperty(s,t,{enumerable:!0,get:n[t]})},o:(e,s)=>Object.prototype.hasOwnProperty.call(e,s)};const s=window.React;var n=e.n(s);const t=window.wp.element,a=window.wp.i18n,i=window.wp.components,r=window.wp.primitives,o=window.ReactJSXRuntime,c=(0,o.jsx)(r.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)(r.Path,{d:"M4 9v1.5h16V9H4zm12 5.5h4V13h-4v1.5zm-6 0h4V13h-4v1.5zm-6 0h4V13H4v1.5z"})}),p=window.wp.apiFetch;var l=e.n(p);const _=()=>{const{baseUrl:e,setBaseUrl:s,companyName:r,setCompanyName:p,apiUsername:_,setApiUsername:d,apiPassword:h,setApiPassword:m,isTesting:y,setIsTesting:g,isSaving:u,setIsSaving:w,message:x,setMessage:v,handleSave:S,handleTestConnection:P,saveSettings:j}=(()=>{const[e,s]=(0,t.useState)(""),[n,i]=(0,t.useState)(""),[r,o]=(0,t.useState)(""),[c,p]=(0,t.useState)(""),[_,d]=(0,t.useState)(!1),[h,m]=(0,t.useState)(!1),[y,g]=(0,t.useState)(!1),[u,w]=(0,t.useState)("");return(0,t.useEffect)((()=>{l()({path:"/wp/v2/settings"}).then((e=>{const n=e;s(n.spire_sync_settings.spire_api.base_url||""),i(n.spire_sync_settings.spire_api.company_name||""),o(n.spire_sync_settings.spire_api.api_username||""),p(n.spire_sync_settings.spire_api.api_password||"")}))}),[]),{baseUrl:e,setBaseUrl:s,companyName:n,setCompanyName:i,apiUsername:r,setApiUsername:o,apiPassword:c,setApiPassword:p,isTesting:_,setIsTesting:d,isSaving:h,setIsSaving:m,isValidConnection:y,setIsValidConnection:g,message:u,setMessage:w,handleTestConnection:async()=>{d(!0),w("");let s={success:!1,message:""};l()({path:"/spire_sync/v1/test-connection",method:"POST",data:{base_url:e,company_name:n,api_username:r,api_password:c}}).then((e=>{s=e,s.success||(d(!1),g(!1),w((0,a.__)("Invalid credentials. Please try again.","spire-sync"))),d(!1),g(!0),w((0,a.__)("Connection successful!","spire-sync"))})).catch((e=>{d(!1),g(!1),w((0,a.__)("An error occurred while testing the connection. Please try again later.","spire-sync")),console.error(e)}))},handleSave:async()=>{m(!0),w("")},saveSettings:async()=>{m(!0),w(""),l()({path:"/wp/v2/settings",method:"POST",data:{spire_sync_settings:{spire_api:{base_url:e,company_name:n,api_username:r,api_password:c}}}}).then((e=>{console.log("Settings saved:",e),w((0,a.__)("Settings saved successfully.","spire-sync")),m(!1)})).catch((e=>{w((0,a.__)("Error saving settings.","spire-sync")),m(!1),console.error(e)}))}}})();return(0,o.jsxs)("div",{className:"spire-sync-settings-container",children:[(0,o.jsx)("h1",{children:(0,a.__)("Spire Sync Settings","spire-sync")}),x&&(0,o.jsx)(i.Notice,{status:"success",isDismissible:!0,onDismiss:()=>v(""),children:x}),(0,o.jsx)(i.Panel,{header:"Settings",children:(0,o.jsx)(n().Fragment,{children:(0,o.jsxs)(i.PanelBody,{title:(0,a.__)("API Settings","spire-sync"),initialOpen:!0,icon:c,children:[(0,o.jsx)(i.PanelRow,{children:(0,o.jsx)(i.__experimentalInputControl,{__next40pxDefaultSize:!0,label:(0,a.__)("Base URL","spire-sync"),value:e,onChange:e=>s(e||""),help:(0,a.__)("Enter the base URL for the Spire API (e.g., http://example.com/api/v2)","spire-sync"),style:{width:"400px"}})}),(0,o.jsx)(i.PanelRow,{children:(0,o.jsx)(i.__experimentalInputControl,{__next40pxDefaultSize:!0,label:(0,a.__)("Company Name","spire-sync"),value:r,onChange:e=>p(e||""),style:{width:"400px"}})}),(0,o.jsx)(i.PanelRow,{children:(0,o.jsx)(i.__experimentalInputControl,{__next40pxDefaultSize:!0,label:(0,a.__)("API Username","spire-sync"),value:_,onChange:e=>d(e||""),style:{width:"400px"}})}),(0,o.jsx)(i.PanelRow,{children:(0,o.jsx)(i.__experimentalInputControl,{__next40pxDefaultSize:!0,label:(0,a.__)("API Password","spire-sync"),type:"password",value:h,onChange:e=>m(e||""),style:{width:"400px"}})}),(0,o.jsx)(i.PanelRow,{children:(0,o.jsx)(i.Button,{variant:"secondary",onClick:P,disabled:y,children:y?(0,a.__)("Testing...","spire-sync"):(0,a.__)("Test Connection","spire-sync")})})]})},"0")}),(0,o.jsx)(i.Button,{variant:"primary",onClick:j,disabled:u,children:u?(0,a.__)("Saving...","spire-sync"):(0,a.__)("Save Settings","spire-sync")})]})};document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("spire-sync-settings-root");e&&(0,t.createRoot)(e).render((0,o.jsx)(_,{}))}))})();